let cards=document.getElementById("cards"),cartBodyInner=document.querySelector(".cart__body-cards"),cartBody=document.querySelector(".cart__body"),cartFooter=document.getElementById("cart__footer"),cardsData=[{id:"1",title:"Краска Wallquest, Brownsone MS90102",img:"1.jpg",price:"6000",filterClasses:{newClass:!1,available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!0,inCart:0,filter:!1},{id:"2",title:"Краска Wallquest, Brownsone MS90102",img:"2.png",price:"4800",filterClasses:{newClass:!1,available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!1,inCart:0,filter:!1},{id:"3",title:"Краска Wallquest, Brownsone MS90102",img:"3.png",price:"5290",filterClasses:{newClass:!1,available:!1,contract:"contract",exclusive:!1,sale:!1},popular:!1,inCart:0,filter:!1},{id:"4",title:"Краска Wallquest, Brownsone MS90102",img:"4.png",price:"2800",filterClasses:{newClass:!1,available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!1,inCart:0,filter:!1},{id:"5",title:"Краска Wallquest, Brownsone MS90102",img:"5.png",price:"3400",filterClasses:{newClass:"new",available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!1,inCart:0,filter:!0},{id:"6",title:"Краска Wallquest, Brownsone MS90102",img:"6.png",price:"6000",filterClasses:{newClass:!1,available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!0,inCart:0,filter:!1},{id:"7",title:"Краска Wallquest, Brownsone MS90102",img:"7.png",price:"4800",filterClasses:{newClass:!1,available:!1,contract:"contract",exclusive:!1,sale:!1},popular:!0,inCart:0,filter:!1},{id:"8",title:"Краска Wallquest, Brownsone MS90102",img:"8.png",price:"5290",filterClasses:{newClass:!1,available:!1,contract:!1,exclusive:!1,sale:!1},popular:!0,inCart:0,filter:!1},{id:"9",title:"Краска Wallquest, Brownsone MS90102",img:"9.png",price:"2800",filterClasses:{newClass:!1,available:"available",contract:!1,exclusive:"exclusive",sale:!1},popular:!0,inCart:0,filter:!1},{id:"10",title:"Краска Wallquest, Brownsone MS90102",img:"10.png",price:"3400",filterClasses:{newClass:!1,available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!1,inCart:0,filter:!1},{id:"11",title:"Краска Wallquest, Brownsone MS90102",img:"1.jpg",price:"6000",filterClasses:{newClass:!1,available:!1,contract:"contract",exclusive:"exclusive",sale:!1},popular:!0,inCart:0,filter:!1},{id:"12",title:"Краска Wallquest, Brownsone MS90102",img:"2.png",price:"4800",filterClasses:{newClass:!1,available:!1,contract:"contract",exclusive:!1,sale:"sale"},popular:!0,inCart:0,filter:!1},{id:"13",title:"Краска Wallquest, Brownsone MS90102",img:"6.png",price:"5290",filterClasses:{newClass:!1,available:!1,contract:"contract",exclusive:"exclusive",sale:"sale"},popular:!1,inCart:0,filter:!1},{id:"14",title:"Краска Wallquest, Brownsone MS90102",img:"4.png",price:"2800",filterClasses:{newClass:"new",available:"available",contract:"contract",exclusive:!1,sale:!1},popular:!0,inCart:0,filter:!0},{id:"15",title:"Краска Wallquest, Brownsone MS90102",img:"8.png",price:"3400",filterClasses:{newClass:"new",available:"available",contract:"contract",exclusive:!1,sale:"sale"},popular:!0,inCart:0,filter:!0}],basket=JSON.parse(localStorage.getItem("data"))||[];function generateCards(){return cards.innerHTML=cardsData.map(e=>{let{id:t,title:l,img:a,price:i,popular:r,filter:n,filterClasses:{newClass:s,available:c,contract:o,sale:d,exclusive:u}}=e;e=basket.find(e=>e.id===t)||[];return`
        <div id="product-id-${t}" class="card cardId hover ${s} ${c} ${o} ${d} ${u}" data-price="${i}" data-sort="${i}" data-popular="${r}" data-new="${n}" data-filter="new">
          <div class="card__image-block"><img class="card__image" src="./images/cards/${a}" alt=${l} /></div>
          <div class="card__content-block">
            <h3 class="card__title">${l}</h3>
            <div class="card__price">${i} ₽</div>
            <div class="card__btn-position">
              <div id="${t}" class="quantity">
                ${void 0===e.item?0:e.item}
              </div>
              <button onclick="increment(${t})" class="card__btn btnAdd"></button>
            </div>
          </div>
        </div>
      `}).join("")}generateCards();let generateCartItems=()=>{0!==basket.length?cartBodyInner.innerHTML=basket.map(e=>{let{id:t,item:l}=e;e=cardsData.find(e=>e.id==t)||[];return document.querySelector(".cart__body-descr").style.display="flex",`
        <div class="cart__item">
          <img class="cart__item-img" src="./images/cards/${e.img}" alt="${e.title}" data-id="" />
          <div class="cart__item-descr">
              <h4 class="cart__item-descr-title">${e.title}</h4>
              <div class="cart__item-price">${e.price*l} ₽</div>
          </div>
          <div class="cart__item-buttons">
            <button onclick="decrement(${t})" class="btn-minus"></button>
            <span id="${t}">${l}</span>
            <button onclick="increment(${t})" class="btn-plus"></button>
          </div>
          <button onclick="removeItem(${t})" class="btn-remove"></button>
          <button class="btn-restore"></button>
        </div>
      `}).join(""):(cartBody.style.color="black",document.querySelector(".cart__body-descr").style.display="none",cartBodyInner.innerHTML=`
      <h2> The cart is empty </h2>
    `)},increment=(generateCartItems(),e=>{let t=e,l=basket.find(e=>e.id===t);void 0===l?basket.push({id:t,item:1}):l.item+=1,generateCartItems(),update(t),localStorage.setItem("data",JSON.stringify(basket))}),decrement=e=>{let t=e,l=basket.find(e=>e.id===t);void 0!==l&&0!==l.item&&(--l.item,update(t),basket=basket.filter(e=>0!==e.item),generateCartItems(),localStorage.setItem("data",JSON.stringify(basket)))},update=t=>{var e=basket.find(e=>e.id===t);document.getElementById(t).innerHTML=e.item,calculation(),totalAmount()},removeItem=e=>{let t=e;basket=basket.filter(e=>e.id!==t),generateCartItems(),totalAmount(),calculation(),localStorage.setItem("data",JSON.stringify(basket))},clearCart=()=>{basket=[],generateCartItems(),calculation(),totalAmount(),localStorage.setItem("data",JSON.stringify(basket))},totalAmount=()=>{var e;0!==basket.length?(e=basket.map(e=>{let{item:t,id:l}=e;e=cardsData.find(e=>e.id==l)||[];return console.log(e),t*e.price}).reduce((e,t)=>e+t,0),cartFooter.innerHTML=`
      <div class="count-block"><span>Итого</span><span class="totalCount">${e} ₽</span></div>
      <button class="orderBtn">Оформить заказ</button>
    `):cartFooter.innerHTML=""},calculation=(totalAmount(),()=>{let e=document.getElementById("cart-count"),t=document.querySelector(".cart__body-title");var l=basket.map(e=>e.item).reduce((e,t)=>e+t,0);e.innerHTML=l,t.innerHTML=l+" "+declOfNum(l,["товар","товара","товаров"])});function declOfNum(e,t){return cases=[2,0,1,1,1,2],t[4<e%100&&e%100<20?2:cases[e%10<5?e%10:5]]}calculation();let cardsCount=document.querySelectorAll(".card");if(document.querySelector(".card-count").innerHTML=cardsCount.length+" "+declOfNum(cardsCount.length,["товар","товара","товаров"]),window.NodeList&&!NodeList.prototype.forEach){thisArg=thisArg||window;for(let e=0;e<this.length;e++)callback.call(thisArg,this[e],e,this)}const dropdownFunc=()=>{document.querySelectorAll(".dropdown").forEach(function(e){const t=e.querySelector(".dropdown__button"),l=e.querySelector(".dropdown__list"),a=e.querySelector(".dropdown__list-wrap"),i=l.querySelectorAll(".dropdown__list-item"),r=e.querySelector(".dropdown__input"),n=(t.addEventListener("click",function(e){e.preventDefault(),l.classList.toggle("dropdown__list--visible"),t.style.display="none",a.style.display="block",document.body.style.overflow="hidden",document.body.style.marginRight=function(){let e=document.createElement("div");e.style.width="50px",e.style.height="50px",e.style.overflowY="scroll",e.style.visibility="hidden",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return e.remove(),t}()+"px"}),i.forEach(e=>{e.addEventListener("click",function(e){e.stopPropagation(),t.innerText=this.innerText,r.value=this.dataset.value,n()})}),()=>{l.classList.remove("dropdown__list--visible"),document.body.style.overflow="visible",a.style.display="none",t.style.display="block",document.body.style.marginRight=""});document.addEventListener("click",function(e){e.target!==t&&n()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&n()})})},mySortAsc=(dropdownFunc(),document.querySelector('.dropdown__list-item[data-value="expensive"]').addEventListener("click",()=>{mySortDesc("data-price")}),document.querySelector('.dropdown__list-item[data-value="cheap"]').addEventListener("click",()=>{mySortAsc("data-price")}),document.querySelector('.dropdown__list-item[data-value="popular"]').addEventListener("click",()=>{mySortPopularAndNew("data-popular")}),document.querySelector('.dropdown__list-item[data-value="new"]').addEventListener("click",()=>{mySortPopularAndNew("data-new")}),l=>{let a=document.querySelector(".cards");for(let t=0;t<a.children.length;t++)for(let e=t;e<a.children.length;e++){var i;+a.children[t].getAttribute(l)>+a.children[e].getAttribute(l)&&(i=a.replaceChild(a.children[e],a.children[t]),insertAfter(i,a.children[t]))}}),mySortDesc=l=>{let a=document.querySelector(".cards");for(let t=0;t<a.children.length;t++)for(let e=t;e<a.children.length;e++){var i;+a.children[t].getAttribute(l)<+a.children[e].getAttribute(l)&&(i=a.replaceChild(a.children[e],a.children[t]),insertAfter(i,a.children[t]))}},mySortPopularAndNew=l=>{let a=document.querySelector(".cards");for(let t=0;t<a.children.length;t++)for(let e=t;e<a.children.length;e++){var i;"true"!==a.children[t].getAttribute(l)&&(i=a.replaceChild(a.children[e],a.children[t]),insertAfter(i,a.children[t]))}},insertAfter=(e,t)=>t.parentNode.insertBefore(e,t.nextSibling),cardsFilter=()=>{let e=document.querySelectorAll(".toggle-button");e.forEach(e=>{e.addEventListener("change",cardsFilter)}),filterResults(getClassOfCheckedCheckboxes(e))};function getClassOfCheckedCheckboxes(t){let l=[];if(t&&0<t.length)for(let e=0;e<t.length;e++){var a=t[e];a.checked&&l.push(a.dataset.filter)}return l}function filterResults(a){let t=document.querySelectorAll(".card"),i=[];if(t&&!(t.length<=0)){for(let e=0;e<t.length;e++){let l=t[e];if(0<a.length){let t=!0;for(let e=0;e<a.length;e++){var r=a[e];if(l.classList.contains(r)){t=!1;break}}t&&i.push(l)}}for(let e=0;e<t.length;e++)t[e].style.display="block";if(!(i.length<=0))for(let e=0;e<i.length;e++)i[e].style.display="none"}}cardsFilter(),document.querySelector(".cartBtn").addEventListener("click",()=>{document.querySelector(".cart").style.display="block",window.scrollTo(0,0),document.body.style.overflow="hidden",document.querySelector(".btn-close").addEventListener("click",function(e){e.preventDefault(),document.querySelector(".cart").style.display="none",document.body.style.overflow="visible"})});const prev=document.querySelector(".slide__arrow.slide__arrow-prev"),next=document.querySelector(".slide__arrow.slide__arrow-next"),slides=document.querySelectorAll(".slide"),dots=document.querySelectorAll(".slide__dot");let index=0;const activeSlide=e=>{for(item of slides)item.classList.remove("activeBlock");slides[e].classList.add("activeBlock")},activeDot=e=>{for(slideDot of dots)slideDot.classList.remove("active");dots[e].classList.add("active")},nextSlide=()=>{index==slides.length-1?index=0:index++,activeSlide(index),activeDot(index)},prevSlide=()=>{0==index?index=slides.length-1:index--,activeSlide(index)},hamburger=(dots.forEach((e,t)=>{e.addEventListener("click",()=>{index=t,activeSlide(index),activeDot(index)})}),next.addEventListener("click",nextSlide),prev.addEventListener("click",prevSlide),setInterval(nextSlide,4e3),document.querySelector(".menu-btn")),nav=document.querySelector(".nav"),navMenu=document.querySelector(".nav__list");hamburger.addEventListener("click",()=>{hamburger.classList.toggle("display-block"),navMenu.classList.toggle("display-block"),nav.classList.toggle("display-block")}),document.querySelectorAll(".nav__item").forEach(e=>{e.addEventListener("click",()=>{navMenu.classList.toggle("display-block"),nav.classList.toggle("display-block")})}),document.querySelector(".main__section-filter-link").addEventListener("click",()=>{document.querySelector(".aside").style.display="block",document.querySelector(".aside").addEventListener("click",e=>{document.querySelector(".aside").style.display="none"})});